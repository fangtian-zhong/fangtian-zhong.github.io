<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>CSCI 591 Malicious Code Analysis</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" type="image/x-icon" href="https://www.traviswpeters.com/cs476-2021-spring/favicon.ico">

  <!-- Fonts & TextFormatting -->
  <link href="Computer%20Security_files/css.css" rel="stylesheet">
  <link href="Computer%20Security_files/all.css" rel="stylesheet"> <!--load all fontawesome styles -->

  <!-- Styles -->
  <link rel="stylesheet" href="Computer%20Security_files/bootstrap.min.css">
  <link rel="stylesheet" href="Computer%20Security_files/prism.css"> <!-- Prism JS & CSS downloaded from: https://prismjs.com/download.html#themes=prism-okaidia&languages=markup+css+clike+javascript+bash+c+csharp+cpp+cmake+docker+git+http+hpkp+hsts+java+javadoc+javadoclike+json+latex+liquid+makefile+markdown+markup-templating+mongodb+nasm+nginx+perl+php+phpdoc+php-extras+plsql+python+regex+ruby+rust+sql+vim+yaml&plugins=line-numbers+command-line+unescaped-markup+normalize-whitespace+toolbar -->
  <link rel="stylesheet" href="Computer%20Security_files/style.css">

  <!-- Misc. -->
  <link rel="stylesheet" href="Computer%20Security_files/bootstrap-toc.min.css">
<style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}
</style><script type="text/javascript" async="" src="Computer%20Security_files/MathJax.js"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style></head>


<body data-spy="scroll" data-target="#toc"><div id="MathJax_Message" style="display: none;"></div>

<div class="container-fluid col-sm-12 p-4 mb-4">
<div class="row flex-xl-nowrap m-0">

<div class="d-none d-xl-block col-xl-2">
</div>

<div class="col-12 col-md-12 col-xl-8 bg-white rounded shadow-lg pb-4">
<div>
  <!--Thanks, Tim Holman! http://tholman.com/github-corners/ -->
<!-- <a href="https://github.com/traviswpeters/cs476-2021-spring/" class="github-corner" aria-label="View source on GitHub"><svg width="25" height="25" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style> -->

<nav class="nav navbar navbar-expand-xl navbar-static-top navbar-light bg-white">

    <!-- title item -->

    <a class="navbar-brand" href="MalCodeA.html">Home</a>


    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">




                <!-- link to section of this page -->
                <li class="nav-item">
                    <a class="nav-link" href="MalCodeA.html#logistics-in-a-nutshell">#Logistics</a>
                </li>





                <!-- link to section of this page -->
                <li class="nav-item">
                    <a class="nav-link" href="MalCodeA.html#schedule">#Schedule</a>
                </li>





                <!-- link to section of this page -->
                <li class="nav-item">
                    <a class="nav-link" href="MalCodeA.html#grading">#Grading</a>
                </li>





                <!-- link to section of this page -->
                <li class="nav-item">
                    <a class="nav-link" href="MalCodeA.html#assignments">#Assignments</a>
                </li>





                <!-- link to section of this page -->
                <li class="nav-item">
                    <a class="nav-link" href="MalCodeA.html#faqs">#FAQs</a>
                </li>





                <!-- link to a separate page on this site -->
                <li class="nav-item">
                    <a class="nav-link" href="labs.html">Labs</a>
                </li>





                <!-- link to a separate page on this site -->
                <li class="nav-item">
                    <a class="nav-link" href="resources.html">Resources</a>
                </li>
            
        
        </ul>
    </div>
</nav>

</div>

<div id="coursetitle">
  <span style="color: #777; font-weight:200; font-size:1.0rem; font-style: italic;">Welcome to</span>
  <h1 data-toc-skip="">
  CSCI 591: Malicious Code Analysis
  <br> &amp;
  CSCI xxx: Software Security
  </h1>
  <!--<span style="color: #777; font-weight:200; font-size:1.0rem; font-style: italic;">Montana State University, Fall 2023 </span>-->
</div>


<!-- ACTIVE Announcements -->

<!-- OLD Announcements (hidden in comment environment) -->



<h1 class="pb-4" id="lab-01-environment-variables--set-uid-programs-lab"><a href="project4.html#lab-01-environment-variables--set-uid-programs-lab">Project4 </a></h1>
<h5 class="text-center pt-0 m-0" id="due-tuesday-02022021--1159-am-mst"><a href="project3.html#due-tuesday-02022021--1159-am-mst">Due: Tuesday [12/05/2023] @ 11:59 PM (MST) </a></h5>

<h2 class="titletext" id="environment-variables--set-uid-programs-lab"><a href="project4.html#environment-variables--set-uid-programs-lab">Project4: Kernel Debugging</a></h2>
<p class="subtitletext">Adapted from the book Practical Malware Analysis: The Hands-On Guide to Dissecting Malicious Software.</p>

<p>The learning objective of this project is for students to familiarize with WinDbg commands for kernel debugging. The kernel is the heart of the operating system, and it resides in the file ntoskrnl.exe. If we want to
    trace back the system libraries to the kernel functions, instead of merely having its effect returned, we should utilize kernel-debugging tools. Among them, WinDbg is the most useful one provided by Microsoft.All system APIs will finally
    transfer the invocation to the kernel, as shown in the figure below, from the "Practical Malware Analysis" book.</p>

<p> <img src="assets/img/NativeAPI.png" alt="NativeAPI"></p>



<h3 id="resources"><a href="resources.html#resources">Resources </a></h3>

<ul>
  <li>Codes related to this project can be found in our class’s slides, Specifically, see <a href="assets/slides/CSCI_591_Malicious_Code_Analysis_22.pptx" target="_blank">slides1</a>. <a href="assets/slides/CSCI_591_Malicious_Code_Analysis_23.pptx" target="_blank">slides2</a><a href="assets/slides/CSCI_591_Malicious_Code_Analysis_26.pptx" target="_blank">slides3</a><a href="assets/slides/CSCI_591_Malicious_Code_Analysis_27.pptx" target="_blank">slides4</a></li>
    <li>A related <a href="https://www.youtube.com/watch?v=QuFJpH3My7A" target="_blank">video lecture</a> for WinDbg Basics for malware Analysis, recorded by OALabs.</li>
  <li>More information about kernel debugging with <a href="https://dennisbabkin.com/blog/?t=setup-windbg-preview-for-kernel-debugging-via-fast-network-in-vmware-vm#breakpoint_bsod" target="_blank">breakpoints </a>.</li>
  <li><a href="https://blog.lamarranet.com/wp-content/uploads/2021/09/WinDbg-Cheat-Sheet.pdf" target="_blank">Checklist for WinDbg Commands</a></li>
</ul>

<h2 class="titletext" id="lab-tasks"><a href="project4.html#lab-tasks">Project Tasks </a></h2>
<p class="subtitletext">This project has been tested on the pre-built SEED VM (Ubuntu 20.04 VM).</p>

<h3 id="task-1-manipulating-environment-variables"><a href="project4.html#task-1-manipulating-environment-variables">Task1: Parent Process </a></h3>

<p>Launch Process Explorer as Administrator. Scroll to the bottom and find the Notepad process. (There may be more than one, as shown below.)
The flag is the name of the parent process, covered by a green box in the image below.</p>


<p><img src="assets/img/ctf1.png" alt="CaptureTheFlag1"></p>

<h3 id="task-2-passing-environment-variables-parent---child"><a href="project4.html#task-2-passing-environment-variables-parent---child">Task 2: Crash Message </a></h3>

<p>The flag is covered by a green box in the image below.
    <img src="assets/img/ctf2.png" alt="CaptureTheFlag2">
</p>



<!-- https://emgithub.com -->
<script src="./project4_files/embed.js.download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<!--<div id="nkf0aj4z40a" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-comment">// Compile:</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-comment">//  $ gcc myprintenv.c -o myprintenv</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"><span class="hljs-comment">//</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-comment">// Run the program and redirect output to a text file:</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"><span class="hljs-comment">//  $ ./myprintenv &gt; myenv1</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">char</span> **environ;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="13"><div class="hljs-ln-n" data-line-number="13"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="13"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printenv</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="14"><div class="hljs-ln-n" data-line-number="14"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="14">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="15"><div class="hljs-ln-n" data-line-number="15"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="15">    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="16"><div class="hljs-ln-n" data-line-number="16"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="16">    <span class="hljs-keyword">while</span> (environ[i] != <span class="hljs-literal">NULL</span>) {</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="17"><div class="hljs-ln-n" data-line-number="17"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="17">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>, environ[i]);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="18"><div class="hljs-ln-n" data-line-number="18"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="18">        i++;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="19"><div class="hljs-ln-n" data-line-number="19"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="19">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="20"><div class="hljs-ln-n" data-line-number="20"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="20">}</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="21"><div class="hljs-ln-n" data-line-number="21"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="21"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="22"><div class="hljs-ln-n" data-line-number="22"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="22"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="23"><div class="hljs-ln-n" data-line-number="23"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="23">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="24"><div class="hljs-ln-n" data-line-number="24"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="24">    <span class="hljs-keyword">pid_t</span> childPid;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="25"><div class="hljs-ln-n" data-line-number="25"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="25">    <span class="hljs-keyword">switch</span>(childPid = fork()) {</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="26"><div class="hljs-ln-n" data-line-number="26"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="26">    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:   <span class="hljs-comment">/* child process */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="27"><div class="hljs-ln-n" data-line-number="27"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="27">        printenv();</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="28"><div class="hljs-ln-n" data-line-number="28"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="28">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="29"><div class="hljs-ln-n" data-line-number="29"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="29">    <span class="hljs-keyword">default</span>:  <span class="hljs-comment">/* parent process */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="30"><div class="hljs-ln-n" data-line-number="30"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="30">        <span class="hljs-comment">// printenv();</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="31"><div class="hljs-ln-n" data-line-number="31"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="31">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="32"><div class="hljs-ln-n" data-line-number="32"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="32">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="33"><div class="hljs-ln-n" data-line-number="33"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="33">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/myprintenv.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/myprintenv.c">myprintenv.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>-->
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>


<!--<h4 id="task-22"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-22">Task 2.2 </a></h4>

<p>Now comment out the <code class=" highlighter-rouge language-plaintext">printenv()</code> statement in the “child process” case,
and uncomment the <code class=" highlighter-rouge language-plaintext">printenv()</code> statement in the “parent process” case.
Compile and run the code again, and describe your
observation. Save the output in another file (e.g., <code class=" highlighter-rouge language-plaintext">myenv2</code>).</p>

<h4 id="task-23"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-23">Task 2.3 </a></h4>

<p>Compare the difference of these two files using the <code class=" highlighter-rouge language-plaintext">diff</code> command.
Please draw your conclusions.</p>
-->
<h3 id="task-3-environment-variables-and-execve"><a href="project4.html#task-3-environment-variables-and-execve">Task 3: WarBird </a></h3>

    <p>Find the function shown in the image below.</p>
<p>The flag is covered by a green box in the image below.</p>
<img src="assets/img/ctf3.png" alt="CaptureTheFlag3">

<!--
<h4 id="task-31"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-31">Task 3.1 </a></h4>

<p>Please compile and run the following program, and describe your observations.
This program simply executes a program called <code class=" highlighter-rouge language-plaintext">/usr/bin/env</code>,
which prints out the environment variables of the current process.</p>
-->
<!-- https://emgithub.com -->
<script src="./project4_files/embed.js(1).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<!--<div id="mdwo95rw8qa" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-comment">// Compile:</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-comment">//  $ gcc myenv_execve.c -o myenv_execve</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">char</span> **environ;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10">    <span class="hljs-keyword">char</span> *argv[<span class="hljs-number">2</span>];</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11">    argv[<span class="hljs-number">0</span>] = <span class="hljs-string">"/usr/bin/env"</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12">    argv[<span class="hljs-number">1</span>] = <span class="hljs-literal">NULL</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="13"><div class="hljs-ln-n" data-line-number="13"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="13"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="14"><div class="hljs-ln-n" data-line-number="14"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="14">    execve(argv[<span class="hljs-number">0</span>], argv, <span class="hljs-literal">NULL</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="15"><div class="hljs-ln-n" data-line-number="15"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="15"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="16"><div class="hljs-ln-n" data-line-number="16"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="16">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="17"><div class="hljs-ln-n" data-line-number="17"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="17">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/myenv_execve.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/myenv_execve.c">myenv_execve.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>-->
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>

<!--
<h4 id="task-32"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-32">Task 3.2 </a></h4>

<p>Change the invocation of <code class=" highlighter-rouge language-plaintext">execve()</code> in to the following;
describe your observations.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-c"><code class=" language-c"><span class="token function">execve</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> argv<span class="token punctuation">,</span> environ<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><div class="toolbar"></div></div></div></div>

<h4 id="task-33"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-33">Task 3.3 </a></h4>

<p>Please draw your conclusions regarding how the new program gets its environment variables.</p>
-->
<h3 id="task-4-environment-variables-and-system"><a href="project4.html#task-4-environment-variables-and-system">Task 4:Magic </a></h3>

<p>Find the word Magic in nt.</p>
<p>The flag is covered by a green box in the image below.</p>
    <img src="assets/img/ctf4.png" alt="CaptureTheFlag4">

<!-- https://emgithub.com -->
<script src="./project4_files/embed.js(2).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<!--<div id="tfrqa1ojw3o" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-comment">// Compile:</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-comment">//  $ gcc myenv_system.c -o myenv_system</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10">    system(<span class="hljs-string">"/usr/bin/env"</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/myenv_system.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/myenv_system.c">myenv_system.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>-->
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>


<h3 id="task-5-environment-variables-and-set-uid-programs"><a href="project4.html#task-5-environment-variables-and-set-uid-programs">Task 5: Module  </a></h3>

    <p>Find this code.</p>
<p>The flag is covered by a green box in the image below.</p>
<img src="assets/img/ctf5.png" alt="CaptureTheFlag5">

<!--
<h4 id="task-51"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-51">Task 5.1 </a></h4>

<p>Use the following program that can print out all the environment variables in the current process.
Verify that your implementation correctly prints the environment variables.</p>
-->
<!-- https://emgithub.com -->
<!--<script src="./project4_files/embed.js(3).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<div id="46ayyxfi5iy" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-comment">// Print environment variables using environ.</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-comment">//</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"><span class="hljs-comment">// Compile:</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-comment">//  $ gcc myenv_environ.c -o myenv_environ</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">char</span> **environ;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[], <span class="hljs-keyword">char</span>* envp[])</span> </span>{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11">    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12">    <span class="hljs-keyword">while</span> (environ[i] != <span class="hljs-literal">NULL</span>) {</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="13"><div class="hljs-ln-n" data-line-number="13"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="13">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>, environ[i]);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="14"><div class="hljs-ln-n" data-line-number="14"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="14">        i++;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="15"><div class="hljs-ln-n" data-line-number="15"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="15">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="16"><div class="hljs-ln-n" data-line-number="16"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="16">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="17"><div class="hljs-ln-n" data-line-number="17"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="17">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/myenv_environ.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/myenv_environ.c">myenv_environ.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>


<h4 id="task-52"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-52">Task 5.2 </a></h4>

<p>Compile the above program, change its ownership to <code class=" highlighter-rouge language-plaintext">root</code>, and make it a Set-UID program.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code class=" language-bash">$ <span class="token function">sudo</span> <span class="token function">chown</span> root myenv_environ   <span class="token comment"># chown = (ch)ange (own)er</span>
$ <span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">4755</span> myenv_environ   <span class="token comment"># chmod = (ch)ange file (mod)e bits</span></code></pre><div class="toolbar"></div></div></div></div>

<h4 id="task-53"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-53">Task 5.3 </a></h4>

<p>In your shell (you need to be in a normal user account, not the <code class=" highlighter-rouge language-plaintext">root</code> account),
use the <code class=" highlighter-rouge language-plaintext">export</code> command to set the following environment variables <em>(<strong>NOTE:</strong> they may exist already!)</em>:</p>

<ul>
  <li><code class=" highlighter-rouge language-plaintext">PATH</code> <em>— prepend the current directory symbol to <code class=" highlighter-rouge language-plaintext">PATH</code></em></li>
  <li><code class=" highlighter-rouge language-plaintext">LD_LIBRARY_PATH</code> <em>— prepend the current directory symbol to <code class=" highlighter-rouge language-plaintext">LD_LIBRARY_PATH</code></em></li>
  <li><code class=" highlighter-rouge language-plaintext">TASK5</code>  <em>— this is a non-standard variable; define this however you want</em></li>
</ul>

<p><em>To be clear, these environment variables should be set in the user’s shell process.</em></p>

<blockquote>
  <p>If you are uncertain about the <code class=" highlighter-rouge language-plaintext">export</code> syntax, there is an example in Task 6.</p>
</blockquote>

<p>After you have exported the above environment variables into the user’s shell environment,
run the Set-UID program from Task 5.2 in your shell. After you type the
name of the program in your shell, the shell forks a child process, and
uses the child process to run the program. Please check whether all the
environment variables you set in the shell process (parent) are inherited in the Set-UID child process.
Describe your observations.
If there are any surprises to you, describe them.</p>

<h3 id="task-6-path-and-set-uid-programs"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-6-path-and-set-uid-programs">Task 6: <code class=" highlighter-rouge language-plaintext">PATH</code> and Set-UID Programs </a></h3>

<p>In this task, we study how Set-UID programs deal with environment variables.
Specifically, we examine the <code class=" highlighter-rouge language-plaintext">PATH</code> environment variable and its potential impact on Set-UID programs.
Because <code class=" highlighter-rouge language-plaintext">system()</code> runs commands by invoking a shell, calling <code class=" highlighter-rouge language-plaintext">system()</code> within a Set-UID program is quite dangerous.
One concern is that the actual behavior of the shell program can be affected by environment variables, such as <code class=" highlighter-rouge language-plaintext">PATH</code>;
these environment variables are provided by the user, who may be malicious.
By changing these variables, malicious users can potentially control the behavior of the Set-UID program.</p>

<p>In <code class=" highlighter-rouge language-plaintext">Bash</code>, you can change the <code class=" highlighter-rouge language-plaintext">PATH</code> environment variable in the following way
(this example adds the directory <code class=" highlighter-rouge language-plaintext">/home/seed</code> to the beginning of the <code class=" highlighter-rouge language-plaintext">PATH</code> environment variable):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code class=" language-bash">$ <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/home/seed:<span class="token environment constant">$PATH</span></code></pre><div class="toolbar"></div></div></div></div>

<p>The Set-UID program below is supposed to execute the <code class=" highlighter-rouge language-plaintext">/bin/ls</code>
command; however, the programmer only uses the relative path for the
<code class=" highlighter-rouge language-plaintext">ls</code> command, rather than the absolute path:</p>
-->
<!-- https://emgithub.com -->
<!--<script src="./project4_files/embed.js(4).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<div id="jug76lgbo5" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5">    system(<span class="hljs-string">"ls"</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/ls_vuln.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/ls_vuln.c">ls_vuln.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>


<p>Please compile the above program, change its owner to <code class=" highlighter-rouge language-plaintext">root</code>, and make it a Set-UID program.</p>

<p>Can you make this Set-UID program run your code (e.g., code that launches a new shell) instead of <code class=" highlighter-rouge language-plaintext">/bin/ls</code>?</p>

<p>If you can, is your code running with root privileges? Describe and explain your observations.</p>

<div class="card bg-secondary border-primary">
  <div class="card-body">
    <h4 class="card-title">Shell Countermeasures</h4>
    <h6 class="card-subtitle mb-2 text-muted">An important change is needed to circumvent shell countermeasures</h6>

    <p>The <code class=" highlighter-rouge language-plaintext">system(cmd)</code> function executes the <code class=" highlighter-rouge language-plaintext">/bin/sh</code> program first, and then asks this shell program to run the <code class=" highlighter-rouge language-plaintext">cmd</code> command.
In Ubuntu 20.04 (and several versions before), <code class=" highlighter-rouge language-plaintext">/bin/sh</code> is actually a symbolic link pointing to <code class=" highlighter-rouge language-plaintext">/bin/dash</code>.
This shell program has a countermeasure that prevents itself from being executed in a Set-UID process.
Basically, if <code class=" highlighter-rouge language-plaintext">dash</code> detects that it is executed in a Set-UID process, it immediately changes the effective user ID to the process’s real user ID, essentially dropping its privileges.</p>

    <p>Since our victim program is a Set-UID program, the countermeasure in <code class=" highlighter-rouge language-plaintext">/bin/dash</code> can prevent our attack.
To see how our attack works without such a countermeasure, we will link <code class=" highlighter-rouge language-plaintext">/bin/sh</code> to another shell that does not have such a countermeasure.
There is another shell program called <code class=" highlighter-rouge language-plaintext">zsh</code> in our Ubuntu 20.04 VM.
Use the following commands to link <code class=" highlighter-rouge language-plaintext">/bin/sh</code> to <code class=" highlighter-rouge language-plaintext">/bin/zsh</code>, and to reset <code class=" highlighter-rouge language-plaintext">/bin/sh</code> to <code class=" highlighter-rouge language-plaintext">/bin/dash</code>, respectively:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code class=" language-bash">$ <span class="token function">sudo</span> <span class="token function">ln</span> -sf /bin/zsh /bin/sh   <span class="token comment"># set shell to zsh - zsh has no set-uid countermeasure</span>
$ <span class="token function">sudo</span> <span class="token function">ln</span> -sf /bin/dash /bin/sh  <span class="token comment"># set shell to dash - dash has a set-uid countermeasure</span></code></pre><div class="toolbar"></div></div></div>    </div>

  </div>
</div>

<h3 id="task-7-ld_preload-and-set-uid-programs"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-7-ld_preload-and-set-uid-programs">Task 7: <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> and Set-UID Programs </a></h3>

<p>In this task, we study how Set-UID programs deal with environment variables.
Specifically, we examine the <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> environment variable and its potential impact on Set-UID programs.
Several environment variables, including
<code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code>, <code class=" highlighter-rouge language-plaintext">LD_LIBRARY_PATH</code>, and others with the <code class=" highlighter-rouge language-plaintext">LD_</code> prefix influence the behavior of the dynamic linker/loader.
A dynamic linker/loader is the part of an operating system (OS) that loads an executable from persistent storage to RAM, and
links the shared libraries needed by the executable at run time.</p>

<p>In Linux, <code class=" highlighter-rouge language-plaintext">ld.so</code> or <code class=" highlighter-rouge language-plaintext">ld-linux.so</code>, are the dynamic linker/loader
(<code class=" highlighter-rouge language-plaintext">ld-linux.so</code> supports ELF, which is a common file format for executables today).
Among the environment variables that affect the behavior of the dynamic linker/loader, <code class=" highlighter-rouge language-plaintext">LD_LIBRARY_PATH</code> and <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> are the two that we are concerned in this lab.
In Linux,
<code class=" highlighter-rouge language-plaintext">LD_LIBRARY_PATH</code> is a colon-separated set of directories where libraries should be searched for first, before the standard set of directories.
<code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> specifies a list of additional, user-specified, shared libraries to be loaded before all others.
In this task, we will only focus on <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code>.</p>

<h4 id="task-71"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-71">Task 7.1 </a></h4>

<p>First, we will see how these environment variables influence the behavior of the dynamic linker/loader when running a normal program.
Please follow these steps:</p>

<ol>
  <li>
    <p>Let us build a dynamically linked library.
Create the following program, and name it <code class=" highlighter-rouge language-plaintext">mylib.c</code>.
This program basically overrides the <code class=" highlighter-rouge language-plaintext">sleep()</code> function
 in <code class=" highlighter-rouge language-plaintext">libc</code>:</p>

    <div class="language-c highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-c"><code class=" language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">sleep</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">/* If this is invoked by a privileged program, you can do damages here! */</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"I am not sleeping!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"></div></div></div>    </div>
  </li>
  <li>
    <p>We can compile the above program using the following commands
   (in the <code class=" highlighter-rouge language-plaintext">-lc</code> argument, the second character is the lowercase letter “L”):</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code class=" language-bash">$ gcc -fPIC -g -c mylib.c
$ gcc -shared -o libmylib.so.1.0.1 mylib.o -lc</code></pre><div class="toolbar"></div></div></div>    </div>
  </li>
  <li>
    <p>Now, set the <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> environment variable:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-bash"><code class=" language-bash">$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_PRELOAD</span><span class="token operator">=</span>./libmylib.so.1.0.1</code></pre><div class="toolbar"></div></div></div>    </div>
  </li>
  <li>
    <p>Finally, compile the following program <code class=" highlighter-rouge language-plaintext">myprog</code> within the same
directory as the dynamically linked library you created above (<code class=" highlighter-rouge language-plaintext">libmylib.so.1.0.1</code>):</p>

    <div class="language-c highlighter-rouge"><div class="highlight"><div class="code-toolbar"><pre class="highlight language-c"><code class=" language-c"><span class="token comment">/* myprog.c */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"></div></div></div>    </div>
  </li>
</ol>

<h4 id="task-72"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-72">Task 7.2 </a></h4>

<p>After you have done Task 7.1, run <code class=" highlighter-rouge language-plaintext">myprog</code> under the following conditions, and observe what happens.</p>

<ul>
  <li>Make <code class=" highlighter-rouge language-plaintext">myprog</code> a regular program, and run it as a normal user.</li>
  <li>Make <code class=" highlighter-rouge language-plaintext">myprog</code> a Set-UID root program, and run it as a normal user.</li>
  <li>Make <code class=" highlighter-rouge language-plaintext">myprog</code> a Set-UID root program, export the <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code>
environment variable again in the root account and run it.
    <blockquote>
      <p>You can run <code class=" highlighter-rouge language-plaintext">sudo su</code> to login as root. Make sure to <code class=" highlighter-rouge language-plaintext">exit</code> when you are done.</p>
    </blockquote>
  </li>
  <li>Make <code class=" highlighter-rouge language-plaintext">myprog</code> a Set-UID user1 program (i.e., the owner is user1,
which is another user account), export the <code class=" highlighter-rouge language-plaintext">LD_PRELOAD</code> environment
variable again in a different user’s account (not-root user) and run
it. <em>(<strong>NOTE:</strong> You may create a new, non-root user for this part)</em></li>
</ul>

<h4 id="task-73"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-73">Task 7.3 </a></h4>

<p>You should be able to observe different behaviors in the scenarios
described above, even though you are running the same program. You need
to figure out what causes the difference. Environment variables play a
role here. Please design an experiment to figure out the main causes,
and explain why the behaviors you observed in the previous part are different.
<em>(<strong>HINT:</strong> the child process may not inherit the <code class=" highlighter-rouge language-plaintext">LD_</code> environment variables!).</em></p>

<h3 id="task-8-system-versus-execve"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-8-system-versus-execve">Task 8: <code class=" highlighter-rouge language-plaintext">system()</code> versus <code class=" highlighter-rouge language-plaintext">execve()</code> </a></h3>

<p>Although <code class=" highlighter-rouge language-plaintext">system()</code> and <code class=" highlighter-rouge language-plaintext">execve()</code> can both be used to invoke new programs,
<code class=" highlighter-rouge language-plaintext">system()</code> is quite dangerous if used in a privileged program, such as Set-UID programs.
We have seen how the <code class=" highlighter-rouge language-plaintext">PATH</code> environment variable can
affect the behavior of <code class=" highlighter-rouge language-plaintext">system()</code> (because that variable affects how the underlying shell that <code class=" highlighter-rouge language-plaintext">system()</code> invokes works).
<code class=" highlighter-rouge language-plaintext">execve()</code> does not have this problem, because it does not invoke a shell.
Invoking a shell has dangerous consequences that are concerning even if environment variables are handled properly.
<em>(i.e., the real issue is much worse than improperly handling environment variables!)</em></p>

<p>Consider the following scenario.
Bob works for an auditing agency, and he needs to investigate a company
for a suspected fraud. For the purpose of the investigation, Bob needs to be
able to <strong>read</strong> all the files in the company’s Unix system.
To protect the integrity of the system, however, Bob should not be able to <strong>modify</strong> any files.
To achieve this goal, Vince, the superuser of the system, wrote a special root-owned Set-UID program (see below),
and then gave “execute” permissions to Bob. This program requires Bob to type a
file name at the command line, and then it will run <code class=" highlighter-rouge language-plaintext">/bin/cat</code> to
display the specified file. Since the program is running as a root, it
can display any file Bob specifies.
However, since the <code class=" highlighter-rouge language-plaintext">cat</code> program does not support write operations,
Vince is confident that Bob cannot use this special audit program to modify any files.</p>
-->
<!-- https://emgithub.com -->
<!--<script src="./project4_files/embed.js(5).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<div id="afl269lqs1" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8">    <span class="hljs-keyword">char</span> *v[<span class="hljs-number">3</span>];</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10">    <span class="hljs-keyword">if</span> (argc &lt; <span class="hljs-number">2</span>) {</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Audit! Please type a file name.\n"</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12">        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="13"><div class="hljs-ln-n" data-line-number="13"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="13">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="14"><div class="hljs-ln-n" data-line-number="14"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="14"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="15"><div class="hljs-ln-n" data-line-number="15"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="15">    v[<span class="hljs-number">0</span>] = <span class="hljs-string">"/bin/cat"</span>; v[<span class="hljs-number">1</span>] = argv[<span class="hljs-number">1</span>]; v[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="16"><div class="hljs-ln-n" data-line-number="16"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="16">    <span class="hljs-keyword">char</span> *command = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">strlen</span>(v[<span class="hljs-number">0</span>]) + <span class="hljs-built_in">strlen</span>(v[<span class="hljs-number">1</span>]) + <span class="hljs-number">2</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="17"><div class="hljs-ln-n" data-line-number="17"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="17">    <span class="hljs-built_in">sprintf</span>(command, <span class="hljs-string">"%s %s"</span>, v[<span class="hljs-number">0</span>], v[<span class="hljs-number">1</span>]);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="18"><div class="hljs-ln-n" data-line-number="18"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="18"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="19"><div class="hljs-ln-n" data-line-number="19"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="19">    <span class="hljs-comment"><span class="hljs-comment">/*</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="20"><div class="hljs-ln-n" data-line-number="20"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="20"><span class="hljs-comment">     * Use only one of the following (comment out the other):</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="21"><div class="hljs-ln-n" data-line-number="21"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="21"><span class="hljs-comment">     */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="22"><div class="hljs-ln-n" data-line-number="22"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="22"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="23"><div class="hljs-ln-n" data-line-number="23"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="23">    <span class="hljs-comment">//system(command);</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="24"><div class="hljs-ln-n" data-line-number="24"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="24">    execve(v[<span class="hljs-number">0</span>], v, <span class="hljs-number">0</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="25"><div class="hljs-ln-n" data-line-number="25"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="25"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="26"><div class="hljs-ln-n" data-line-number="26"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="26">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="27"><div class="hljs-ln-n" data-line-number="27"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="27">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/catall.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/catall.c">catall.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>


<h4 id="task-81"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-81">Task 8.1 </a></h4>

<p>Compile the above program and make it a root-owned Set-UID program.
This program uses <code class=" highlighter-rouge language-plaintext">system()</code> to invoke the <code class=" highlighter-rouge language-plaintext">cat</code> command.
Assuming the role of Bob, can you compromise the integrity of the system?
For example, can you remove a file that is not writable to you?</p>

<h4 id="task-82"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-82">Task 8.2 </a></h4>

<p>Comment out the <code class=" highlighter-rouge language-plaintext">system(command)</code> statement, and uncomment the <code class=" highlighter-rouge language-plaintext">execve()</code> statement;
the program will use <code class=" highlighter-rouge language-plaintext">execve()</code> to invoke the command.
Compile the program, and make it a root-owned Set-UID program.
Do your attacks from Task 8.1 still work?
Please describe and explain your observations.</p>

<h3 id="task-9-capability-leaking"><a href="https://www.traviswpeters.com/cs476-2021-spring/labs/lab01.html#task-9-capability-leaking">Task 9: Capability Leaking </a></h3>

<p>To follow the <strong>Principle of Least Privilege</strong>, Set-UID programs should
relinquish their root privileges as soon as such privileges are no longer needed.
Moreover, sometimes, the program needs to hand over its
control to the user; in this case, root privileges must be revoked. The
<code class=" highlighter-rouge language-plaintext">setuid()</code> system call can be used to set the user identity of the calling process, which can be used to revoke privilege.
According to the manual,</p>

<blockquote>
  <p><code class=" highlighter-rouge language-plaintext">setuid()</code> sets the effective user ID of the calling process.
If the calling process is privileged (…), the real UID and saved set-user-ID are also set.</p>
</blockquote>

<p>Therefore, if a Set-UID program with
effective UID 0 calls <code class=" highlighter-rouge language-plaintext">setuid(n)</code>, the process will become a normal
process, with its UID being set to <code class=" highlighter-rouge language-plaintext">n</code>.</p>

<p>When revoking privileges, one of the most common mistakes is <em>capability leaking</em>.
The process may have gained some privileged capabilities when
it was still privileged; when the privilege is downgraded, if the
program does not clean up those capabilities, they may still be
accessible by the non-privileged process. In other words, although the
effective user ID of the process becomes non-privileged, the process is
still privileged because it possesses privileged capabilities.</p>

<p>Compile the following program, change its owner to root, and make it a
Set-UID program. Run the program as a normal user, and describe what
you observe. Will the file <code class=" highlighter-rouge language-plaintext">/etc/zzz</code> be modified? Please explain.</p>
-->
<!-- https://emgithub.com -->
<!--<script src="./project4_files/embed.js(6).download"></script>
<style>.lds-ring{margin:1rem auto;position:relative;width:60px;height:60px}.lds-ring div{box-sizing:border-box;display:block;position:absolute;width:48px;height:48px;margin:6px;border:6px solid #fff;border-radius:50%;animation:lds-ring 1.2s cubic-bezier(0.5,0,0.5,1) infinite;border-color:#888 transparent transparent transparent}.lds-ring div:nth-child(1){animation-delay:-.45s}.lds-ring div:nth-child(2){animation-delay:-.3s}.lds-ring div:nth-child(3){animation-delay:-.15s}@keyframes lds-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style>
<div id="ksywgfc5r8" class="emgithub-container" style="margin: 1em 0px;"><div style="white-space: pre; tab-size: 8;"><code class="c hljs cpp" style="padding: 1rem; border-radius: 0.3rem 0.3rem 0px 0px; border: 1px solid rgb(221, 221, 221);"><table class="hljs-ln"><tbody><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="1"><div class="hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="1"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="2"><div class="hljs-ln-n" data-line-number="2"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="2"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="3"><div class="hljs-ln-n" data-line-number="3"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="3"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="4"><div class="hljs-ln-n" data-line-number="4"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="4"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;fcntl.h&gt;</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="5"><div class="hljs-ln-n" data-line-number="5"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="5"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="6"><div class="hljs-ln-n" data-line-number="6"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="6"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="7"><div class="hljs-ln-n" data-line-number="7"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="7">{</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="8"><div class="hljs-ln-n" data-line-number="8"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="8">    <span class="hljs-keyword">int</span> fd;</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="9"><div class="hljs-ln-n" data-line-number="9"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="9"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="10"><div class="hljs-ln-n" data-line-number="10"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="10">    <span class="hljs-comment"><span class="hljs-comment">/*</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="11"><div class="hljs-ln-n" data-line-number="11"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="11"><span class="hljs-comment">     * Assume that /etc/zzz is an important system file,</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="12"><div class="hljs-ln-n" data-line-number="12"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="12"><span class="hljs-comment">     * and it is owned by root with permission 0644.</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="13"><div class="hljs-ln-n" data-line-number="13"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="13"><span class="hljs-comment">     * Before running this program, you should create</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="14"><div class="hljs-ln-n" data-line-number="14"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="14"><span class="hljs-comment">     * the file /etc/zzz first.</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="15"><div class="hljs-ln-n" data-line-number="15"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="15"><span class="hljs-comment">     */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="16"><div class="hljs-ln-n" data-line-number="16"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="16">    fd = open(<span class="hljs-string">"/etc/zzz"</span>, O_RDWR | O_APPEND);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="17"><div class="hljs-ln-n" data-line-number="17"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="17">    <span class="hljs-keyword">if</span> (fd == <span class="hljs-number">-1</span>) {</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="18"><div class="hljs-ln-n" data-line-number="18"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="18">        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Cannot open /etc/zzz\n"</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="19"><div class="hljs-ln-n" data-line-number="19"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="19">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="20"><div class="hljs-ln-n" data-line-number="20"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="20">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="21"><div class="hljs-ln-n" data-line-number="21"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="21"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="22"><div class="hljs-ln-n" data-line-number="22"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="22">    <span class="hljs-comment">// Simulate the tasks conducted by the program</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="23"><div class="hljs-ln-n" data-line-number="23"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="23">    sleep(<span class="hljs-number">1</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="24"><div class="hljs-ln-n" data-line-number="24"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="24"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="25"><div class="hljs-ln-n" data-line-number="25"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="25">    <span class="hljs-comment"><span class="hljs-comment">/*</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="26"><div class="hljs-ln-n" data-line-number="26"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="26"><span class="hljs-comment">     * After the task, elevated privileges are no longer needed;</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="27"><div class="hljs-ln-n" data-line-number="27"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="27"><span class="hljs-comment">     * it is time to relinquish these privileges!</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="28"><div class="hljs-ln-n" data-line-number="28"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="28"><span class="hljs-comment">     * <span class="hljs-doctag">NOTE:</span> getuid() returns the real UID (RUID)</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="29"><div class="hljs-ln-n" data-line-number="29"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="29"><span class="hljs-comment">     */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="30"><div class="hljs-ln-n" data-line-number="30"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="30">    setuid(getuid());</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="31"><div class="hljs-ln-n" data-line-number="31"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="31"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="32"><div class="hljs-ln-n" data-line-number="32"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="32">    <span class="hljs-keyword">if</span> (fork()) {  <span class="hljs-comment">/* parent process */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="33"><div class="hljs-ln-n" data-line-number="33"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="33">        close (fd);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="34"><div class="hljs-ln-n" data-line-number="34"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="34">        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="35"><div class="hljs-ln-n" data-line-number="35"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="35">    } <span class="hljs-keyword">else</span> {  <span class="hljs-comment">/* child process */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="36"><div class="hljs-ln-n" data-line-number="36"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="36"> </td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="37"><div class="hljs-ln-n" data-line-number="37"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="37">        <span class="hljs-comment"><span class="hljs-comment">/*</span></span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="38"><div class="hljs-ln-n" data-line-number="38"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="38"><span class="hljs-comment">         * Now, assume that the child process is compromised, and that</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="39"><div class="hljs-ln-n" data-line-number="39"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="39"><span class="hljs-comment">         * malicious attackers have injected the following statements into this process</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="40"><div class="hljs-ln-n" data-line-number="40"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="40"><span class="hljs-comment">         */</span></td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="41"><div class="hljs-ln-n" data-line-number="41"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="41">        write (fd, <span class="hljs-string">"Malicious Data\n"</span>, <span class="hljs-number">15</span>);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="42"><div class="hljs-ln-n" data-line-number="42"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="42">        close (fd);</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="43"><div class="hljs-ln-n" data-line-number="43"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="43">    }</td></tr><tr><td class="hljs-ln-line hljs-ln-numbers" data-line-number="44"><div class="hljs-ln-n" data-line-number="44"></div></td><td class="hljs-ln-line hljs-ln-code" data-line-number="44">}</td></tr></tbody></table></code></div><div class="file-meta file-meta-light" style="border-width: 0px 1px 1px; border-top-style: initial; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: initial; border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial;"><a target="_blank" href="https://raw.githubusercontent.com/traviswpeters/cs476-code/master/01_envvars_setuid/cap_leak.c" style="float:right">view raw</a>
<a target="_blank" href="https://github.com/traviswpeters/cs476-code/blob/master/01_envvars_setuid/cap_leak.c">cap_leak.c</a>
delivered <span class="hide-in-phone">with ❤ </span>by <a target="_blank" href="https://emgithub.com/">emgithub</a></div></div>
<style>.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:right;color:#ccc;vertical-align:top}.hljs-ln td.hljs-ln-numbers{padding-right:1.25rem}</style>
<link rel="stylesheet" href="./project4_files/github.min.css">
<style>
.emgithub-container .file-meta {
  padding: 0.75rem;
  border-radius: 0 0 0.3rem 0.3rem;
  font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial,
  sans-serif, Apple Color Emoji, Segoe UI Emoji;
}

.emgithub-container .file-meta-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .file-meta-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .file-meta a {
  font-weight: 600;
  text-decoration: none;
  border: 0;
}

.emgithub-container .file-meta-light a {
  color: #666;
}

.emgithub-container .file-meta-dark a {
  color: #fff;
}

/* hide content for small device */
@media (max-width: 575.98px) {
  .emgithub-container .hide-in-phone {
    display: none;
  }
}

.emgithub-container {
  position: relative;
}

.emgithub-container .toolbar {
  position: absolute;
  right: 0px;
  padding: 0.3rem;
}

.emgithub-container .copy-btn {
  display: none;
  border: 1px solid black;
  border-radius: 3px;
  padding: 0.4rem;
  font: bold 1em monospace;
  text-decoration: none;
}

.emgithub-container .copy-btn-light {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-dark {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container:hover .copy-btn {
  display: block;
}

.emgithub-container .copy-btn-light:hover {
  color: #f7f7f7;
  background-color: #586069;
}

.emgithub-container .copy-btn-dark:hover {
  color: #586069;
  background-color: #f7f7f7;
}

.emgithub-container .copy-btn-light:active {
  /* darken #586069 by 20% https://www.cssfontstack.com/oldsites/hexcolortool/ */
  background-color: #252d36;
}

.emgithub-container .copy-btn-dark:active {
  /* darken #f7f7f7 by 20% */
  background-color: #c4c4c4;
}
</style>

-->
<!-- NOTE: This "stub" assumes that page.duedate and page.id variables are defined; the latter should be consistent with our directory naming scheme. -->

<h2 id="submission"><a href="project4.html#submission">Submission </a></h2>

<p>This lab is due Tuesday [12/05/2023] @ 11:45 AM (MST).</p>

<p>Please submit your write-up in <code class=" highlighter-rouge language-plaintext">project4/README.md</code> within your <strong>private</strong> GitHub repository.</p>

<p>You need to submit a detailed lab report to describe what you have done and what you have observed, including relevant screenshots, command snippets, and code snippets.
For any important command snippets or code snippets you must also include a supporting explanation.
<em>Simply including commands/code without any explanation will not receive credit.</em>
For any interesting or surprising observations, you also need to provide explanations.
You are encouraged to pursue further investigation, beyond what is required by the lab description.</p>

<p>Your <code class=" highlighter-rouge language-plaintext">README.md</code> must be written up in valid Markdown.
Please also include any accompanying resources (e.g., source code, makefiles, screenshots).
Please do not commit/include any unnecessary files within your repository (I strongly recommend using a <code class=" highlighter-rouge language-plaintext">.gitignore</code> file).
For general tips on how to write and format your submission, please see the <a href="labs.html">Project Info &amp; Tips page</a>.</p>


<div class="footer">

<footer>
  <div class="copyright">© 2023 <a href="https://fangtian-zhong.github.io/">Fangtian Zhong</a>
- All rights reserved.</div>
  <span>
    This website is powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> &amp; <a href="https://bootswatch.com/yeti/" target="_blank">Yeti</a> / <a href="https://getbootstrap.com/" target="_blank">Bootstrap</a>, and was generated by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.
  </span>
</footer>

<script type="text/javascript">
var m = "This page was last updated: " + document.lastModified;
var p = m.length-8;
document.writeln("<footer>" + m.substring(p, 0) + "</footer>");
</script>


</div>

</div>

<div class="d-none d-xl-block col-xl-2">
    
    <nav id="toc" data-toggle="toc" class="sticky-top"><ul class="nav navbar-nav">
        <li><a class="nav-link" href="project4.html#environment-variables--set-uid-programs-lab">Project4: Kernel Debugging</a>
            <ul class="nav navbar-nav">
                <li><a class="nav-link" href="project4.html#resources">Resources</a></li>
            </ul>
        </li>
        <li><a class="nav-link" href="project4.html#lab-tasks">Project Tasks</a>
            <ul class="nav navbar-nav">
                <li><a class="nav-link" href="project4.html#task-1-manipulating-environment-variables">Task 1: Manipulating Environment Variables</a></li>
                <li><a class="nav-link" href="project4.html#task-2-passing-environment-variables-parent---child">Task 2: Passing Environment Variables (Parent -&gt; Child)</a></li>
                <li><a class="nav-link" href="project4.html#task-3-environment-variables-and-execve">Task 3: Environment Variables and execve()</a></li>
                <li><a class="nav-link" href="project4.html#task-4-environment-variables-and-system">Task 4: Environment Variables and system()</a></li>
                <li><a class="nav-link" href="project4.html#task-5-environment-variables-and-set-uid-programs">Task 5: Environment Variables and Set-UID Programs</a></li>
                <li><a class="nav-link" href="project4.html#task-6-path-and-set-uid-programs">Task 6: PATH and Set-UID Programs</a></li>
                <li><a class="nav-link" href="project4.html#task-7-ld_preload-and-set-uid-programs">Task 7: LD_PRELOAD and Set-UID Programs</a></li>
                <li><a class="nav-link" href="project4.html#task-8-system-versus-execve">Task 8: system() versus execve()</a></li>
                <li><a class="nav-link" href="project4.html#task-9-capability-leaking">Task 9: Capability Leaking</a></li>
            </ul></li><li><a class="nav-link" href="project4.html#submission">Submission</a></li></ul></nav>

</div>

</div>
</div>

<!-- Optional JavaScript for Bootstrap - jQuery first, then Popper.js, then Bootstrap JS -->
<script src="./project4_files/jquery-3.4.1.slim.min.js.download" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="./project4_files/popper.min.js.download" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="./project4_files/bootstrap.min.js.download" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="./project4_files/polyfill.min.js.download"></script>
<script id="MathJax-script" async="" src="./project4_files/tex-mml-chtml.js.download"></script>

<script src="./project4_files/prism.js.download"></script>

<script src="./project4_files/bootstrap-toc.min.js.download"></script>

<script>
$(document).ready(function() {
    /*
     * class hacking: add bootstrap/bootswatch class labels to my custom classes (notes, slides, etc.)
     */

    // admin styles
    $('.new').addClass('badge badge-pill badge-primary');
    $('.announcement').addClass('alert alert-primary').prepend('<h4 class="alert-heading">Class Announcement!</h4>');
    $('.timestamp').prepend('&mdash;Posted ');
    // $('.score').prepend(' &mdash; ');

    // add icons / style class elements...
    $( ".activity" ).each(function(index) {
        $(this).html('<i class="fas fa-lightbulb pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });
    $( ".code" ).each(function(index) {
        $(this).html('<i class="fas fa-file-code pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });
    $( ".slides" ).each(function(index) {
        $(this).html('<i class="fas fa-file-pdf pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });
    $( ".pdf" ).each(function(index) {
        $(this).html('<i class="fas fa-file pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });
    $( ".reading" ).each(function(index) {
        $(this).html('<i class="fas fa-book pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });
    $( ".video" ).each(function(index) {
        $(this).html('<i class="fas fa-play-circle pl-1"></i> ' +$(this).html()+ '' );
        $(this).attr('target', '_blank');
    });

    // add links to all section headers...
    $( ":header" ).each(function(index) {
      var attr = $(this).attr('id');
      if (typeof attr !== typeof undefined && attr !== false) {
        $(this).html( '<a href="#' + attr + '">' +$(this).html()+ ' </a>' );
      }
    });

    // add links to weeks on schedule
    $('td[id^="week"]').filter(function () {
        $(this).html(function(index, text){
            return '<a href="#' + text.toLowerCase().replace(' ', '') + '"><strong>' + text + '</strong></a>';
        });
    });

    // use javascript to detect all external links and add the target='_blank' attribute to them.
    // -> thanks, https://code.luasoftware.com/tutorials/hugo/how-to-create-link-with-target-blanks-in-hugo-markdown/
    var links = document.getElementsByTagName("a");
    for (var i = 0, linksLength = links.length; i < linksLength; i++) {
        if (links[i].hostname != window.location.hostname) {
            links[i].target = '_blank';
        }
    }

});
</script>

<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
  MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
    var TEX = MathJax.InputJax.TeX;
    var COLS = function (W) {
      var WW = [];
      for (var i = 0, m = W.length; i < m; i++)
        {WW[i] = TEX.Parse.prototype.Em(W[i])}
      return WW.join(" ");
    };
    TEX.Definitions.Add({
      environment: {
        psmallmatrix: ['Array',null,'(',')','c',COLS([1/3]),".2em",'S',1],
      }
    });
  });
</script>
<script type="text/javascript" async="" src="./project4_files/latest.js.download">
</script>




</body></html>
